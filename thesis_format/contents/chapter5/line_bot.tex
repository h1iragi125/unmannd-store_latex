\graphicspath{{./contents/chapter5/figures/}}	% 図・画像ファイルが保存されたディレクトリまでのパス
\chapter{LINE Botを用いた遠隔の在庫把握}
	第4章で述べたように，無人店舗の在庫状況に関するデータの収集には，デプスカメラを用いる手法が最適と判断した．本章では，収集したデータとLINE Botを用いて，利用者が場所の制約なく無人店舗の在庫状況を閲覧できるシステムの構築について，LINE Bot，ngrok，システムの動作結果と考察を説明する．

    \section{LINE Bot}
    LINE Botは，LINE上で動作する自動応答プログラムであり，利用者から送られる特定の文字や数字に対し，あらかじめ設定したメッセージを自動で返信する機能を持つ[16]．また，LINEはLINEヤフー株式会社が提供する日本最大級のコミュニケーションアプリであり，総務省による全年代を対象としたソーシャルメディアの利用率調査では，91.1％の人々がLINEを利用していると回答しているため[17]，無人店舗の利用者に限らず多くの人が使用経験のあるアプリケーションだと考える．実際に無人店舗の在庫状況を遠隔から確認する際，慣れ親しんだ画面で操作でき，手軽かつ分かりやすく在庫状況を把握できると考えため，本研究ではLINE Botを用いる．
    LINE Botは，主に公式アカウント，Messaging API，Webhookという３つの要素で構成されている．

        \subsection{公式アカウント}
        LINEは，コミュニケーションをとりたいアカウントに対し，友達追加を行うことで，文字や画像，スタンプのやり取りができる．そのため，LINE Botを利用するにあたり，紐づけるアカウントが必要である．これを公式アカウントと呼び，本研究では，無人店舗の在庫状況を返答する公式アカウントを作成し，利用者が友達追加することで，遠隔の在庫把握を実現する．LINE上のやり取りの様子を\figref{yaritori}に示す．

        \vspace{0.5\baselineskip}
		\begin{figure}[H]
			\centering
			\includegraphics[width=.6\linewidth]{図6.1.png}
			\caption{LINE上のやり取りの様子}
			\label{yaritori}
		\end{figure}

        \subsection{Messaging API}
        Messaging APIは，LINE公式アカウントを通じて，利用者と双方向のコミュニケーションを実現するAPIであり，利用者から送られるメッセージに応答する機能を備えている[18]．
        API（Application Programming Interface）は，ソフトウェアやWebサービスの間をつなぐインターフェースであり，これを利用することで，外部サービスからのデータ取得を実現できる[19]．
        Messaging APIを利用するにあたり，無料で利用できるコミュニケーションプラン，月額5000円のライトプラン，月額15000円のスタンダードプランという，それぞれ返信できるメッセージ数が異なる３つのプランが存在するが，本研究ではLINE Botの有効性を調査するのが目的であり，大量のメッセージを返信する実用段階には満たないため，コミュニケーションプランを用いている．
        \figref{system}に示すLINE Botを用いて在庫状況を把握するシステムの構造から分かる通り，Messaging APIは，Flaskサーバに格納された在庫データを，LINEプラットフォームを通じて利用者に送信するために用いる．ここで，LINEプラットフォームは，LINEヤフー株式会社が提供する通信および制御を行うための基盤であり，Messaging APIはこの基盤上で提供されるサービスの1つである．また， Flaskサーバは，Pythonプログラミング言語を用いたWebアプリケーションフレームワークであり，シンプルかつ軽量，さらに柔軟性や拡張性が高いという特徴がある[20]．本研究では，LINE Botの有効性を調査するのが目的のため，検出した在庫データを保持するサーバとして十分な機能を持ち，無料で利用できるFlaskサーバを用いた．

        \vspace{0.5\baselineskip}
		\begin{figure}[H]
			\centering
			\includegraphics[width=.8\linewidth]{図6.2.png}
			\caption{遠隔在庫把握システムの構造}
			\label{system}
		\end{figure}

        Messaging APIを利用するためには，図6.3に示すLINE BotのMessaging API設定画面（以下LINE Developers画面とする）のように，チャネルアクセストークンの発行が必要である．これは，Messaging APIを安全に利用するための認証キーであり，本研究ではFlaskサーバからLINEプラットフォームへメッセージ送信を行うための身分証としての役割を果たす．図6.3は，リスク回避のため，チャネルアクセストークンを隠して示している．
